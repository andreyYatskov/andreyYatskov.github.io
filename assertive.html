<!DOCTYPE html>
<html>
  <head>
    <title>Test page for Assertive Yields</title>
    <meta charset="UTF-8" />
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <script
      src="https://nD2hE8QXAHT6WkSSZ.ay.delivery/manager/nD2hE8QXAHT6WkSSZ"
      type="text/javascript"
      referrerpolicy="no-referrer-when-downgrade"
    ></script>
  </head>

  <body>
    <div id="app">
      <div data-ay-manager-id="companion-above"></div>
    </div>


    <script>
      window.assertive = {
        debug: true, // append the query string 'assertiveYield=debug' or add this local storage entry 'localStorage.setItem("assertiveYield", "debug")' to enable dynamically
        entityId: "nD2hE8QXAHT6WkSSZ", // your entity id from the dashboard see: https://suite.assertiveyield.com/welcome
        schainSid: "",
        analytics: {
          sampleRate: 1, // 1 = all sessions are tracked, 0.5 = 50% of the sessions are tracked...
          custom: {
            // optional dimensions for custom data, they expect null or string
            layout: null,
            userState: null,
            custom_1: null,
            custom_2: null,
            custom_3: null,
            custom_4: null,
            custom_5: null,
            custom_6: null,
            custom_7: null,
            custom_8: null,
            custom_9: null
          }
        }
      };
      var adUnitCode;
      window.ayManagerEnv = window.ayManagerEnv || 
      { 
        cmd: [], 
        settings: { prebidSettingsss : { config:  {ccc: 33 } } }
      };
      window.ayManagerEnv.debug = true;
      window.ayManagerEnv.cmd.push(() => {
        console.log(
          "Yield Manager script finally loads"
        );
        window.ayManagerEnv.onEvent("error", (err) => {
          console.log("on error", err);
        });

        window.ayManagerEnv.onEvent("beforePageChange", (e) => {
          console.log("on beforePageChange", e);
        });

        window.ayManagerEnv.onEvent("afterPageChange", (e) => {
          console.log("on afterPageChange", e);
        });

        window.ayManagerEnv.onEvent("beforeDefineSlot", (adUnitInstanceCode, slot) => {
          console.log("on beforeDefineSlot", adUnitInstanceCode, slot);
          adUnitCode = adUnitInstanceCode;
          slot.size = [[300, 250]];
        });

        window.ayManagerEnv.onEvent("afterDefineSlot", (adUnitInstanceCode, slot) => {
          console.log("on afterDefineSlot", adUnitInstanceCode, slot);
        });
      });
      
      setInterval(() => {
        console.log("30 sec refresh for", adUnitCode);
        if (adUnitCode) {
          window.ayManagerEnv.cmd.push(() => {
            // window.ayManagerEnv.refresh(["/57806026/nadav_rnd_test"]);
            window.ayManagerEnv.refresh([adUnitCode], { useInstanceCodes: true });
          });
        }
      }, 30000);

      window.shouldShowAd = function () {
        return false;
      };

      window.ayManagerEnv.cmd.push(() => {
        window.ayManagerEnv.display("companion-above");
      });

      console.log("window.ayManagerEnv", window.ayManagerEnv);
    </script>
    <script src="https://nD2hE8QXAHT6WkSSZ.ay.delivery/client-v2.js" async></script>
  </body>
</html>
