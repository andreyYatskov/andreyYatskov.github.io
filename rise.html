<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Rise Ad Example</title>
    <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
    <script>
      const href = new URL(location.href);
      const adSlot = href.searchParams.get('adslot') || '/57806026/Amazon_abendzeitung-muenchen.de_MW_320x50_BA';
      const adSize = href.searchParams.get('adsize') ||'320x50';
      window.googletag = window.googletag || { cmd: [] };

      googletag.cmd.push(function() {
        googletag.pubads().disableInitialLoad();
        googletag.defineSlot(adSlot, adSize.split('x'), "test-ad").addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
      });

      window.googletag.cmd.push(() => {
        if (window.googletag.apiReady) {
          console.warn('Gpt api is ready');
          ['slotRequested', 'slotResponseReceived', 'slotRenderEnded'].forEach((eventName) => {
            window.googletag.pubads().addEventListener(eventName, (event) => {
              const { slot } = event;
              const slotId = slot.getSlotElementId();
              console.warn(eventName, slotId, 'getResponseInformation' in slot ? slot.getResponseInformation() : '');
            });
          });
        } else {
          console.warn('Gpt error - api isnot ready');
        }
      });
    </script>
    <script>
      window.riseCallback = function (error, instance) {
        console.warn('riseCallback', { error, instance });
        if (error) {
          // ignore
        }
        AUCTION_INSTANCE = instance;
        instance.on('AdImpression', function (data) {
          console.warn('IMPRESSION CALLBACK:', JSON.stringify(data, null, 2));
        });
      };
    </script>
    <script src='https://sdk.rfunbox.com/sdk/auction.loader.js?id=676ae5642de1d50001d4b69c&org=5857d2ee263dc90002000001&auction_callback=riseCallback'></script>
  </head>
  <body>
    <h2>Test page for Rise</h2>
    <div style="background: lightblue; height: 1000px; padding: 5px">
       <div style="margin: 10px 0">
        <label for="adSlot">Ad slot:</label>
        <input type="text" id="input-adslot" name="adSlot" style="width: 500px">
      </div>
       <div style="margin: 10px 0">
         <label>Ad size:</label>
          <select id="input-adsize">
              <option value="320x50">320x50</option>
              <option value="320x250">320x250</option>
              <option value="160x600">160x600</option>
          </select>
       </div>  
      <button onclick="apply()">Apply</button>
      <div style="background: lightslategrey; height:300px; width: 1000px; margin-top: 20px">
        <div id="test-ad"></div>
        <script>
          googletag.cmd.push(function () {
            googletag.display('test-ad');
            console.warn('display test ad ');
          });
        </script>
      </div>
    </div>
   <script>
      document.getElementById('input-adslot').value = adSlot;
      document.getElementById('input-adsize').value = adSize;
      function apply() {
  
        href.searchParams.set('adslot', document.getElementById("input-adslot").value);
        document.location = href.toString();
      }
    </script>
  </body>
</html>
